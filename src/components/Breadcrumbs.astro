---
interface Crumb {
  label: string
  href: string
}

const crumbs: Crumb[] = [{ label: 'home', href: '/' }]
const segments = Astro.url.pathname.split('/').filter(Boolean)

// Build up the path progressively
let currentPath = ''
for (const segment of segments) {
  currentPath += `/${segment}`
  crumbs.push({
    label: segment.replace(/_-/g, ' '),
    href: currentPath,
  })
}
---

<nav class="breadcrumbs" aria-label="Breadcrumb">
  {
    crumbs.map((crumb, index) => (
      <span class="crumb-wrapper">
        {index === crumbs.length - 1 ? (
          <span class="separator">/</span>
          <span class="crumb current" aria-current="page">
            {crumb.label}
          </span>
        ) : (
          <a href={crumb.href} class="crumb">
            <span class="separator">/</span>
            {crumb.label}
          </a>
        )}
      </span>
    ))
  }
</nav>

<style>
  .breadcrumbs {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .crumb-wrapper {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .separator {
    color: var(--theme-text-dim);
    user-select: none;
  }

  .crumb {
    color: var(--theme-text);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .crumb.current {
    color: var(--theme-text-dim);
  }

  a.crumb:hover {
    color: var(--theme-accent);
  }
</style>
